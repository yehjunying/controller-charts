<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Angular Material style sheet -->
    <link rel="stylesheet" href="node_modules/angular-material/angular-material.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" href="css/onos/opensans.css">
    <link rel="stylesheet" href="css/onos/onos.css">
    <link rel="stylesheet" href="css/onos/onos-theme.css">
    <link rel="stylesheet" href="css/onos/common.css">
    <style>
        a {
            cursor: pointer;
        }
    </style>
</head>

<body ng-app="myApp" ng-cloak>

    <div ng-controller="appCtrl">
        <a ng-click="go('/dashboard')">dashboard</a> |
        <a ng-click="go('/accountCfg')">accountCfg</a> |
        <a ng-click="go('/configHistory?from=somewhere')">ConfigHistory</a> |
        <a ng-click="go('/configHistoryDetail?from=somewhere&id=20170501011000000&other=20170501011009999')">configHistoryDetail</a> |
        <a ng-click="go('/event')">Event</a>
        <div ng-view></div>
    </div>

    <script src="node_modules/es5-shim/es5-shim.min.js"></script>
    <script src="node_modules/es5-shim/es5-sham.min.js"></script>
    <script src="node_modules/es6-shim/es6-shim.min.js"></script>
    <script src="node_modules/es6-shim/es6-sham.min.js"></script>

    <!-- Angular Material requires Angular.js Libraries -->
    <script src="node_modules/angular/angular.min.js"></script>
    <script src="node_modules/angular-route/angular-route.min.js"></script>
    <script src="node_modules/angular-cookies/angular-cookies.min.js"></script>
    <script src="node_modules/angular-animate/angular-animate.min.js"></script>
    <script src="node_modules/angular-aria/angular-aria.min.js"></script>
    <script src="node_modules/angular-messages/angular-messages.min.js"></script>

    <script src="node_modules/oclazyload/dist/ocLazyLoad.min.js"></script>

    <!-- Angular Material Library -->
    <script src="node_modules/angular-material/angular-material.min.js"></script>

    <script src="node_modules/lodash/lodash.min.js"></script>

    <!-- Services -->
    <script src="app/services/mock/websocket.js"></script>
    <script src="app/services/mock/nav.js"></script>

    <!-- Your application bootstrap  -->
    <script type="text/javascript">

        angular.module("myApp", ['ngRoute', 'oc.lazyLoad', 'mockUtils', 'onosNav', 'ngMaterial'])
            .config(function ($routeProvider) {
                $routeProvider
                    .when("/dashboard", {
                        templateUrl: "app/view/dashboard/dashboard.html",
                        controller: 'OvDashboardCtrl',
                        resolve: {
                            files: ['$ocLazyLoad', function ($ocLazyLoad) {
                                return $ocLazyLoad.load([
                                    {
                                        files:[
                                            'node_modules/jquery/dist/jquery.min.js',
                                            'node_modules/chart.js/dist/Chart.min.js',
                                            'elasticsearch.angular.js',
                                            'app/services/essearch.js',
                                            'app/view/dashboard/controller-chart.js',
                                            'app/view/dashboard/dashboard.js'
                                        ],
                                        serie: true
                                    },
                                    {
                                        files: [
                                            'node_modules/bootstrap/dist/css/bootstrap.min.css',
                                            'app/view/dashboard/dashboard.css'
                                        ],
                                        serie: true
                                    }
                                ]);
                            }]
                        }
                    })
                    .when("/accountCfg", {
                        templateUrl: "app/view/accountCfg/accountCfg.html",
                        controller: 'OvAccountCfgCtrl',
                        resolve: {
                            files: ['$ocLazyLoad', function ($ocLazyLoad) {
                                return $ocLazyLoad.load([
                                    {
                                        files:[
                                            // 'node_modules/jquery/dist/jquery.min.js',
                                            'node_modules/moment/min/moment.min.js',
                                            'app/view/accountCfg/accountCfg.js'
                                        ],
                                        serie: true
                                    },
                                    {
                                        files: [
                                            'node_modules/bootstrap/dist/css/bootstrap.min.css',
                                            'app/view/accountCfg/accountCfg.css'
                                        ],
                                        serie: true
                                    }
                                ]);
                            }]
                        }
                    })
                    .when("/configHistory", {
                        templateUrl: "app/view/configHistory/configHistory.html",
                        controller: 'OvConfigHistoryCtrl',
                        resolve: {
                            files: ['$ocLazyLoad', function ($ocLazyLoad) {
                                return $ocLazyLoad.load([
                                    {
                                        files:[
                                            'node_modules/jquery/dist/jquery.min.js',
                                            'node_modules/moment/min/moment.min.js',
                                            'app/view/configHistory/configHistory.js'
                                        ],
                                        serie: true
                                    },
                                    {
                                        files: [
                                            'app/view/configHistory/configHistory.css'
                                        ],
                                        serie: true
                                    }
                                ]);
                            }]
                        }
                    })
                    .when("/configHistoryDetail", {
                        templateUrl: "app/view/configHistoryDetail/configHistoryDetail.html",
                        controller: 'OvConfigHistoryDetailCtrl',
                        resolve: {
                            files: ['$ocLazyLoad', function ($ocLazyLoad) {
                                return $ocLazyLoad.load([
                                    {
                                        files:[
                                            'app/view/configHistoryDetail/ang-accordion.js',
                                            'node_modules/moment/min/moment.min.js',
                                            'app/view/configHistoryDetail/configHistoryDetail.js'],
                                        serie: true
                                    },
                                    {
                                        files: [
                                            'app/view/configHistoryDetail/configHistoryDetail.css'
                                        ],
                                        serie: true
                                    },
                                    {
                                        files: ['app/view/configHistoryDetail/ang-accordion.css']
                                    }
                                ]);
                            }]
                        }
                    })
                    .when("/event", {
                        templateUrl: "app/view/event/event.html",
                        controller: 'OvEventCtrl',
                        resolve: {
                            files: ['$ocLazyLoad', function ($ocLazyLoad) {
                                return $ocLazyLoad.load([
                                    {
                                        files:[
                                            'node_modules/jquery/dist/jquery.min.js',
                                            'node_modules/chart.js/dist/Chart.min.js',
                                            'node_modules/d3/d3.min.js',
                                            'node_modules/moment/min/moment.min.js',
                                            'elasticsearch.angular.js',
                                            'app/services/essearch.js',
                                            'app/view/event/event-stats-bar.js',
                                            'app/view/event/event.js'
                                        ],
                                        serie: true
                                    },
                                    {
                                        files: [
                                            'app/view/event/event.css'
                                        ],
                                        serie: true
                                    }
                                ]);
                            }]
                        }
                    });
            })
            .controller('appCtrl', ['$scope', '$location', function ($scope, $location) {
                $scope.go = function (url) {
                    var p = url.split('?'),
                        path = p[0],
                        qs = p[1],
                        loc = $location.path(path);

                    if (qs) {
                        qs.split('&').forEach(function (kv) {
                            kv = kv.split('=');
                            loc.search(kv[0], kv[1]);
                        })
                    }
                }
            }])
            .run(['$location', 'WebSocketService', function ($location, wss) {
                wss.setResponseHomeDir('event-resp');
                wss.bindResponseData({
                        dashboardTopRanksDataResponse: function (req) {
                            var deviceCfgs = [
                                {"id": "rest:1.1.1.1:443", "name": "Spine-1", "ip": "1.1.1.1", "role": "Spine", "desc": "Spine Switch", "protocol": "HTTPS", "port": 443, "username": "admin", "password": "admin"},
                                {"id": "rest:1.1.1.2:443", "name": "Spine-2", "ip": "1.1.1.2", "role": "Spine", "desc": "Spine Switch", "protocol": "HTTPS", "port": 443, "username": "admin", "password": "admin"}
                            ];

                            var getRandomInt = function(min, max) {
                                return Math.floor(Math.random() * (max - min + 1)) + min;
                            };

                            var randomTop5Traffic = function() {
                                var i, traffic = [];

                                for (i = 0; i < 5; ++i) {
                                    traffic.push({
                                        device: deviceCfgs[getRandomInt(0, (deviceCfgs.length - 1))].id,
                                        port: getRandomInt(1, 52),
                                        transmitUtilization: getRandomInt(1, 100),
                                        receiveUtilization: getRandomInt(1, 100)
                                    });
                                }

                                return traffic;
                            };

                            var randomTop5DropCount = function() {
                                var i, dropCount = [];

                                for (i = 0; i < 5; ++i) {
                                    dropCount.push({
                                        device: deviceCfgs[getRandomInt(0, (deviceCfgs.length - 1))].id,
                                        port: getRandomInt(1, 52),
                                        transmitDropCount: getRandomInt(1, 10000),
                                        receiveDropCount: getRandomInt(1, 10000)
                                    });
                                }

                                return dropCount;
                            };

                            return {
                                coreLink: {
                                    traffic: randomTop5Traffic(),
                                    dropCount: randomTop5DropCount()
                                },
                                accessLink: {
                                    traffic: randomTop5Traffic(),
                                    dropCount: randomTop5DropCount()

                                }
                            };
                        }
                    });
                $location.path('/dashboard');
            }]);
    </script>

</body>

</html>